â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           EVIDENCE SYSTEM QUICK REFERENCE                    â•‘
â•‘        IPFS + Soroban Proof-of-Funds Verification           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ FILES CREATED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… contracts/evidence/src/lib.rs          - Soroban contract
âœ… contracts/evidence/src/test.rs         - Contract tests
âœ… contracts/evidence/Cargo.toml          - Rust dependencies
âœ… backend/src/routes/evidence.ts         - IPFS upload API
âœ… frontend/lib/crypto/hashUtils.ts       - SHA-256 utilities
âœ… frontend/lib/crypto/verifyEvidence.ts  - Verification logic
âœ… frontend/components/EvidenceSubmission.tsx - React component
âœ… EVIDENCE_SYSTEM_COMPLETE.md            - Full documentation
âœ… .env.evidence.example                  - Config template
âœ… test-evidence-api.sh                   - API test script

ğŸ”§ QUICK SETUP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1ï¸âƒ£ Backend Setup
   cd backend
   npm install multer axios form-data @types/multer
   
   # Configure Pinata
   echo "PINATA_API_KEY=your_key" >> .env
   echo "PINATA_SECRET_KEY=your_secret" >> .env
   
   npm run dev

2ï¸âƒ£ Deploy Contract
   cd contracts/evidence
   soroban contract build
   soroban contract deploy \
     --wasm target/wasm32-unknown-unknown/release/evidence_contract.wasm \
     --source <SECRET_KEY> \
     --rpc-url https://soroban-testnet.stellar.org

3ï¸âƒ£ Test Backend
   chmod +x test-evidence-api.sh
   ./test-evidence-api.sh

ğŸŒ API ENDPOINTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

POST /api/evidence/upload
  â†’ Upload file to IPFS
  â†’ Returns: { cid, ipfsUrl, size, ... }

GET /api/evidence/retrieve/:cid
  â†’ Get IPFS gateway URLs
  â†’ Returns: { cid, gateways[], ... }

GET /api/evidence/health
  â†’ Check IPFS service status
  â†’ Returns: { pinata: { status, configured } }

ğŸ“œ CONTRACT FUNCTIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

submit_evidence(project_id, cid_hash, issuer)
  â†’ Store 32-byte hash on-chain
  â†’ Returns: evidence_index (u64)
  â†’ Requires: issuer authentication

get_evidence(project_id, evidence_index)
  â†’ Retrieve evidence record
  â†’ Returns: Evidence { hash, timestamp, issuer }

verify_evidence(project_id, evidence_index, expected_hash)
  â†’ Verify hash matches
  â†’ Returns: bool (true if valid)

get_evidence_count(project_id)
  â†’ Count evidence for project
  â†’ Returns: u64

ğŸ’» FRONTEND USAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Hash a CID
import { hashCID, hexToBytes } from '../lib/crypto/hashUtils';
const hash = await hashCID("QmABC...");
const bytes = hexToBytes(hash);

// Upload file
const formData = new FormData();
formData.append('file', file);
const { cid } = await fetch('/api/evidence/upload', {
  method: 'POST',
  body: formData,
}).then(r => r.json());

// Verify evidence
import { verifyEvidence } from '../lib/crypto/verifyEvidence';
const result = await verifyEvidence(
  projectId,
  evidenceIndex,
  cid,
  contractAddress
);
console.log("Valid?", result.isValid);

// Use React component
<EvidenceSubmission
  projectId={1001}
  issuerAddress="GDEMO..."
  contractAddress="CCCCC..."
  onSuccess={(index, cid, hash) => console.log("Done!")}
/>

ğŸ” WORKFLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

NGO SUBMITS EVIDENCE:
  1. Select file (image/PDF)
  2. Upload to IPFS via backend â†’ Get CID
  3. Compute SHA-256(CID) â†’ Get hash
  4. Submit to Soroban: submit_evidence(project_id, hash)
  5. Store CID in database linked to evidence_index

DONOR VERIFIES:
  1. Get CID from database
  2. Load file from IPFS using CID
  3. Recompute SHA-256(CID)
  4. Compare with on-chain hash
  5. Match? âœ… Donate | Mismatch? âŒ Block

ğŸ“Š STORAGE COSTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Traditional (Full File):
  1MB file = 1,048,576 bytes on-chain = ğŸ’°ğŸ’°ğŸ’°

With IPFS + Hash:
  32-byte hash on-chain = ğŸ’° (99.99% cheaper!)
  File stored on IPFS = Free (decentralized)

ğŸ§ª TESTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Test contract
cd contracts/evidence
cargo test

# Test API
./test-evidence-api.sh

# Test hash computation
node -e "
const crypto = require('crypto');
const cid = 'QmYwAPJzv5CZsnA625s3Xf2nemtYgPpHdWEz79ojWnPbdG';
const hash = crypto.createHash('sha256').update(cid).digest('hex');
console.log('Hash:', hash);
"

ğŸ”¥ TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ "Cannot find module 'multer'"
   â†’ Run: npm install multer axios form-data @types/multer

âŒ "Pinata authentication failed"
   â†’ Check PINATA_API_KEY and PINATA_SECRET_KEY in .env
   â†’ Test: curl https://api.pinata.cloud/data/testAuthentication

âŒ "Hash mismatch"
   â†’ Verify correct CID is used
   â†’ File may have been modified after upload
   â†’ Recompute: hashCID(cid) and compare

âŒ "IPFS gateway timeout"
   â†’ Try alternative gateways:
     - https://ipfs.io/ipfs/
     - https://cloudflare-ipfs.com/ipfs/
     - https://gateway.pinata.cloud/ipfs/

ğŸ“š DOCUMENTATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Full Guide: EVIDENCE_SYSTEM_COMPLETE.md
  â†’ Architecture diagrams
  â†’ Complete API reference
  â†’ Security best practices
  â†’ Example workflows
  â†’ Troubleshooting guide

ğŸ¯ KEY FEATURES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Tamper-proof: File changes â†’ Hash mismatch
âœ… Cost-optimized: 32 bytes instead of MB
âœ… Decentralized: IPFS prevents censorship
âœ… Verifiable: Anyone can independently verify
âœ… Cryptographic: SHA-256 security
âœ… Scalable: Minimal on-chain storage

ğŸš€ READY TO USE!
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

All components implemented:
  âœ“ Soroban smart contract
  âœ“ Backend IPFS upload
  âœ“ Frontend utilities
  âœ“ React component
  âœ“ Verification system
  âœ“ Complete documentation

Next: Deploy contract â†’ Configure Pinata â†’ Test workflow
